---
title: 模块规范
date: 2020-05-28 23:49:44
tags: 
- 模块化
categories:
- webpack
excerpt: AMD,CMD,CommonJS规范&ES6规范
---

## AMD

异步模块加载规范(AMD,Asynchronorous Module Definition);

浏览器端模块化开发规范;典型的是Require.js

基本语法`require([module],callback)`

module是需要加载的模块,是个数组;callback是等该模块加载成功后执行的回调函数.

require(['math'],function(math){ math.add(2,3) } )

## CMD

通用模块加载规范(CMD,Common Module Definition)

浏览器环境模块加载;典型的是Sea.js

基本语法`var module = require('module-name')`



### AMD和CMD的异同

相同: 

1. 都是异步加载
2. 都是模块加载规范(!????)

不同:

1. AMD加载模块完成后就会执行该模块,所有模块加载完后执行callback函数;(完成后打开)更符合浏览器端.强调依赖前置.用户体验更好;

   CMD加载后遇到require语句才会执行对应的模块;(仅下载,暂不打开).更符合服务器端.强调依赖延迟;性能更好

## CommonJS

同步加载模块,不加载完下面的代码都执行不了

Node.js用的规范.关键是**一个js文件就是一个模块**.

### module.exports ,exports的区别

```js
module.exports = exports = {}
//exports是module.exports的一个引用
//类比于
var a = {}
var b = a;
```

```js
//以对象的形式导出多个变量或函数

//一个模块仅导出一个变量/函数
function test(){}
module.exports = test
```

* 区分函数/变量是以单个导出的方式导出的还是以对象形式导出的.

  ```js
  //1.以单个形式导出的
  //index.js   单个文件就导出一个函数?!会覆盖码?相当于exports这个属性的值是一个函数(方法)
  module.exports = function (){console.log('Single output')}
  //引用
  var sth = require('./index.js')
  sth()
  //可能等价于
  module:{
      exports: function(){console.log('Single output')}
  }
  //2.以对象形式导出的,相当于给exports对象添加了一个方法
  exports.something = function(){console.log('Object Form ')}
  exports.a = 1
  //引用
  var sth = require('./index.js')
  sth.somthing()
  //可能等价于
  module:{
      exports:{
          something:function(){console.log('Object Form ')},
          a:1
      }
  }
  ```

  

module.exports 可以单独范围某一个数据类型

module.exports = {}           var exports = module.exports

所以不能让exports指向一个值(???)

exports.functionName = (req,res,next)=>{...}

module.exports = [functionName]

### export,export default 是ES6规范,区别于module.exports和exports的CommonJS规范

基本用法: 

* import/export /export default

* export let a = 1 ,export function test(){//...}

* export default {  a,test }

  ```js
  //导出 index.js
  let a = 1;
  function test(){} 
  export default {  //注意，export default 整个文件只能使用一次,单独使用export可以多次
    a,
    test
  }
  //导入
  import sth from './index.js'
  //import * from './index.js'     //这样引入怎么用?必须要用as吧?
  //import * as alias from './index.js'  //alias.sthfrommodule
  console.log(sth) 
  
  {
      a:1,
      test:function(){}
  }
  //类似于module.exports.a = 1
  //module.exports.test = function(){}
  ```

  ```js
  //按需导出与导入
  export let a = 1;
  export let show = function(){}
  
  //导入
  import {a, show } from './index.js'
  console.log(a)
  show()
  
  //动态导入
  import('/module').then(module=>{
      //do something with the module
  })
  
  //
  import [module] from './index.js'
  import [module] as Alias from './index.js'
  //这里的module不是自定义的吗? 为什么还要用as另起别名?
  ```

  * 是否还要注意导出文件导出的是单个函数还是整个对象?

  * 不需要.无论是否为单个导出都要解构.所有的单个export语句都会整合成一个对象(?)

    ```js
    export function add(a,b){return a+b}
    import { add } from './index.js'
    ```

    

